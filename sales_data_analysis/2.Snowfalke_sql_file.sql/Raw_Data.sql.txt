Raw_Data.sql


use database sales_analysis_db

create or replace table raw_sales_data (
    Orderno INT,
    Quantity_order INT,
    Price_each FLOAT,
    Order_lineno INT,
    Sales FLOAT,
    Order_date DATE,
    Status STRING,
    QTR_id INT,
    Month_id INT,
    Year_id INT,
    Product_line STRING,
    MSRP FLOAT,
    Product_code STRING,
    Customer_name STRING,
    Phone STRING,
    Address_line1 STRING,
    Address_line2 STRING,
    City STRING,
    State STRING,
    Postal_code STRING,
    Country STRING,
    Contact_last_name STRING,
    Contact_first_name STRING,
    Deal_size STRING
);

select * from raw_sales_data ;

CREATE OR REPLACE FILE FORMAT my_csv_format
TYPE = 'CSV'
FIELD_OPTIONALLY_ENCLOSED_BY='"'
SKIP_HEADER = 1
ERROR_ON_COLUMN_COUNT_MISMATCH = FALSE
DATE_FORMAT = 'MM/DD/YYYY HH24:MI'


COPY INTO raw_sales_data
FROM @SALES_DB_PROJECT/sales_data_sample.csv
FILE_FORMAT = (FORMAT_NAME = 'my_csv_format')
ON_ERROR = 'CONTINUE';


select * from raw_sales_data ;


COPY INTO raw_sales_data
(
  ORDERNO,
  QUANTITY_ORDER,
  PRICE_EACH,
  ORDER_LINENO,
  SALES,
  ORDER_DATE,
  STATUS,
  QTR_ID,
  MONTH_ID,
  YEAR_ID,
  PRODUCT_LINE,
  MSRP,
  PRODUCT_CODE,
  CUSTOMER_NAME,
  PHONE,
  ADDRESS_LINE1,
  ADDRESS_LINE2,
  CITY,
  STATE,
  POSTAL_CODE,
  COUNTRY,
  CONTACT_LAST_NAME,
  CONTACT_FIRST_NAME,
  DEAL_SIZE
)
FROM (
  SELECT 
    t.$1,   -- ORDERNUMBER
    t.$2,   -- QUANTITYORDERED
    t.$3,   -- PRICEEACH
    t.$4,   -- ORDERLINENUMBER
    t.$5,   -- SALES
    t.$6,   -- ORDERDATE
    t.$7,   -- STATUS
    t.$8,   -- QTR_ID
    t.$9,   -- MONTH_ID
    t.$10,  -- YEAR_ID
    t.$11,  -- PRODUCTLINE
    t.$12,  -- MSRP
    t.$13,  -- PRODUCTCODE
    t.$14,  -- CUSTOMERNAME
    t.$15,  -- PHONE
    t.$16,  -- ADDRESSLINE1
    t.$17,  -- ADDRESSLINE2
    t.$18,  -- CITY
    t.$19,  -- STATE
    t.$20,  -- POSTALCODE
    t.$21,  -- COUNTRY
    t.$23,  -- CONTACTLASTNAME
    t.$24,  -- CONTACTFIRSTNAME
    t.$25   -- DEALSIZE
  FROM @SALES_DB_PROJECT/sales_data_sample.csv t
)
FILE_FORMAT = (FORMAT_NAME = 'my_csv_format')
ON_ERROR = 'CONTINUE';

select * from raw_sales_data limit 20 ; 
